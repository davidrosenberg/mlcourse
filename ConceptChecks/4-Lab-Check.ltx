\section{Week 4 Lab: Concept Check Exercises}
\subsection{Subgradients}
\begin{enumerate}
\item ($\star$) If $f:\RR^n\to\RR$ is convex and differentiable at $x$, the
  $\partial f(x) = \{\nabla f(x)\}$.
\begin{solution}
\item[]\Sol By the gradient (first-order) conditions for convexity, we
  know that $\nabla f(x) \in\partial f(x)$.  Next suppose $g\in
  \partial f(x)$.  This means that for all $v\in\RR^n$ and $h\in\RR$ we have
  $$f(x+hv) \geq f(x) + hg^Tv \implies \frac{f(x+hv)-f(x)}{h} \geq g^Tv.$$
  Using $-h$ in place of $h$ gives
  $$f(x-hv) \geq f(x) - hg^Tv \implies g^Tv \geq
  \frac{f(x-hv)-f(x)}{-h}.$$
  Taking limits as $h\to0$ gives
  $$\nabla f(x)^Tv \geq g^Tv \geq \nabla f(x)^Tv.$$
  Thus all terms are equal.  Subtracting gives
  $$(\nabla f(x) - g)^Tv = 0,$$
  which holds for all $v\in\RR^n$.  Letting $v=\nabla f(x) - g$ proves
  $$\|\nabla f(x) - g\|_2^2 = 0$$
  giving the result.
\end{solution}
\item Fix $f:\RR^n\to\RR$ and $x\in\RR^n$. Then the subdifferential $\partial f(x)$ is a
  convex set.
\begin{solution}
\item[]\Sol Let $g_1,g_2\in \partial f(x)$ and $t\in(0,1)$.  We must
  show $(1-t)g_1+tg_2$ is a subgradient.  Note that, for any
  $y\in\RR^n$, we have
  $$\begin{array}{rcl}
    f(x) + ((1-t)g_1+tg_2)^T(y-x) 
    & = & (1-t)(f(x)+g_1^T(y-x)) + t(f(x)+g_2^T(y-x)) \\
    & \leq & (1-t)f(y) + tf(y)\\
    & = & f(y).
  \end{array}$$
\end{solution}
\item 
  \begin{enumerate}
  \item True or False: A subgradient of $f:\RR^n\to\RR$ at $x$ is normal to a
    hyperplane that globally understimates the graph of $f$.
  \item True or False: If $g\in\partial f(x)$ then $-g$ is a descent
    direction of $f$.
  \item True or False: For $f:\RR\to\RR$, if $1,-1\in \partial f(x)$
    then $x$ is a global minimizer of $f$.
  \item True or False: Let $f:\RR^n\to\RR$ and let $g\in \partial
    f(x)$.  Then $\alpha g\in\partial f(x)$ for all $\alpha\in[0,1]$.
  \item True or False: If the sublevel sets of a function are convex,
    then the function is convex.
  \end{enumerate}
\begin{solution}
\item[]\Sol
  \begin{enumerate}
  \item False. The underestimating hyperplane is a subset of
    $\RR^{n+1}$ but a subgradient is an element of $\RR^n$.
  \item False. In lab we considered $f(x_1,x_2)=|x_1|+2|x_2|$ and noted
    that $(1,-2)\in \partial f(3,0)$ but $(-1,2)$ is not a descent
    direction.
  \item True. The subdifferential of $f$ at $x$ is convex, and thus contains $0$.
    If $0$ is a subgradient of $f$ at $x$, then $x$ is a global
    minimizer.
  \item False.  Suppose $f:\RR\to\RR$ is defined by $f(x)=x^2$.  Then
    $\partial f(1) = \{2\}$, and thus doesn't contain $2\alpha$ for
    $\alpha\in[0,1)$.
  \item False.  A counterexample is $f(x)=-e^{-x^2}$.  The converse is
    true though. Functions that have convex sublevel sets are called \textit{quasiconvex}.
  \end{enumerate}
\end{solution}
\item Let $f:\RR^2\to\RR$ be defined by $f(x_1,x_2) = |x_1| +2|x_2|$.
  Compute $\partial f(x_1,x_2)$ for each $x_1,x_2\in\RR^2$.
\begin{solution}
\item[]\Sol Write $f(x_1,x_2) = f_1(x_1,x_2) + f_2(x_1,x_2)$ where
  $f_1(x_1,x_2)=|x_1|$ and $f_2(x_1,x_2)=2|x_2|$.  When $x_1\neq 0$ we
  have $\partial f_1(x_1,x_2) = \{(\sgn(x_1),0)^T\}$ and when $x_1=0$ we
  have
  $$\partial f_1(x_1,x_2) = \{(b,0)^T\mid b\in[-1,1]\}.$$
  When $x_2\neq 0$ we
  have $\partial f_2(x_1,x_2) = \{(0,2\sgn(x_2))^T\}$ and when $x_2=0$ we
  have
  $$\partial f_2(x_1,x_2) = \{(0,c)^T\mid c\in[-2,2]\}.$$
  Combining we have
  $$\partial f(x_1,x_2) = \partial f_1(x_1,x_2) + \partial
  f_2(x_1,x_2),$$
  where we are summing sets.  Recall that if $A,B\subseteq\RR^n$ then
  $$A+B = \{a+b \mid a\in A,b\in B\}.$$
  This gives 4 cases:
  \begin{enumerate}
  \item If $x_1,x_2\neq 0$ this gives $\partial f(x_1,x_2) =
    \{(\sgn(x_1),2\sgn(x_2))^T\}$.  
  \item If $x_1=0$ and $x_2\neq 0$ we have $\partial f(x_1,x_2) =
    \{(b,2\sgn(x_2))^T\mid b\in[-1,1]\}$.  
  \item If $x_1\neq0$ and $x_2= 0$ we have $\partial f(x_1,x_2) =
    \{(\sgn(x_1),c)^T\mid c\in[-2,2]\}$.  
  \item If $x_1=0$ and $x_2=0$ we have $\partial f(x_1,x_2) =
    \{(b,c)^T\mid b\in[-1,1],c\in[-2,2]\}$.  
  \end{enumerate}
\end{solution}
\end{enumerate}
